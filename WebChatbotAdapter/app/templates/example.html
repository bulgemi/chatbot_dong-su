<!DOCTYPE html>
<html lang="kr">
<head>
    <title>ChatOps</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>
<body style="padding:0px;margin:0px;">
<div style="padding:40px">
    <img class="fit-picture" src="{{ url_for('static', filename='image/ChatOps.png') }}" alt="ChatOps">
    <p>
        Web, Mobile 모두 사용 가능하도록 구현하자!
    </p>
</div>
<script src="{{ url_for('static', filename='js/chatux.min.js') }}"></script>
<script>

    const chatux = new ChatUx();

    const opt = {
        renderMode: 'auto',//'auto' or 'pc' or 'mobile'
        buttonOffWhenOpenFrame: false,//only for pc mode
        bot: {
            wakeupText: null,//user input which is automatically send to server on startup
<!--            botPhoto: 'https://riversun.github.io/img/riversun_144.png',//URL of bot photo image-->
            botPhoto: '{{ url_for('static', filename='image/chatbot_icon.png') }}',//URL of bot photo image
            humanPhoto: null,//URL of human photo image
            widget: {
                sendLabel: '보내기',
                placeHolder: '메시지를 입력하세요.'
            }
        },
        api: {
<!--            endpoint: 'https://script.google.com/macros/s/AKfycbwpf8iZfGXkJD6K__oCVQYF35HLBQjYxmKP0Ifrpe_piK4By4rh/exec',-->
            endpoint: 'http://127.0.0.1:8000/engine',
            method: 'GET',
            dataType: 'jsonp',
            errorResponse: {
                output: [
                    {type: 'text', value: 'Sorry, an error occurred'}
                ]
            },
            //you can set custom HTTP-header
            // headers: {
            //     'X-Example-Header': 'Header Value1'
            // },

            //you can set custom query params
            // params: {
            //     'param1': 'myParam1',
            //     'param2': 'myParam2',
            // }
        },
        window: {
            title: 'ChatOps',
            infoUrl: 'https://github.com/riversun/chatux',
            size: {
                width: 350,
                height: 500,
                minWidth: 300,
                minHeight: 300,
                titleHeight: 50
            },
            appearance: {
                border: {
                    shadow: '2px 2px 10px  rgba(0, 0, 0, 0.5)',
                    width: 0,
                    radius: 6
                },
                titleBar: {
                    fontSize: 14,
                    color: 'white',
                    background: '#4784d4',
                    leftMargin: 40,
                    height: 40,
                    buttonWidth: 36,
                    buttonHeight: 16,
                    buttonColor: 'white',
                    buttons: [
                        {
                            fa: 'fas fa-times',
                            name: 'hideButton',
                            visible: true
                        }
                    ],
                    buttonsOnLeft: [
                        {
                            fa: 'fas fa-comment-alt',
                            name: 'info',
                            visible: true
                        }
                    ],
                },
            }
        },
        wakeupButton: {
            right: 20,
            bottom: 20,
            size: 60,
            fontSize: 25
        },
        methods: {
            onChatWindowCreate: (win) => {
                console.log('#onChatWindowCreate');
            },
            onChatWindowPause: (win) => {
                console.log('#onChatWindowPause');
            },
            onChatWindowResume: (win) => {
                console.log('#onChatWindowResume');
            },
            onUserInput: (userInputText) => {

                console.log('#onUserInput userInputText=' + userInputText);

                if (userInputText === 'end') {
                    const consumed = true;
                    chatux.dispose();
                    return consumed;
                }
            },
            //For local test, get the user input text but stop accessing the chat server.
            // onServerProcess: (userInputText) => {
            //     const response = {"output": [{"type": "text", "value": 'You said "' + userInputText + '"'}]};
            //     return response;
            // },
            // onPrepareRequest: (httpClient) => {
            //     httpClient.params.mykey1 = 'valOfmykey1';//set original query param
            // },
            // onFinishRequest: (httpClient) => {
            //     delete httpClient.params.mykey1;
            // },
            onServerResponse: (response) => {
                console.log('#onServerResponse response=' + JSON.stringify(response));
                return response;
            }
        }
    };

    //initialize
    chatux.init(opt);

<!--    let isAutoStartChat = true;-->
    let isAutoStartChat = false;
    if (chatux.isMobileDevice()) {
        isAutoStartChat = false;
    }

    chatux.start(isAutoStartChat);
</script>
</body>
</html>